<!doctype html>

<meta charset="utf-8">

<body>

<script src="pixi.min.js"></script>

<script>



var options = {
      preserveDrawingBuffer: false,
      clearBeforeRender :false,
      autoResize: true,
      transparent: false
};



var renderer = new PIXI.WebGLRenderer(800, 600, options);
document.body.appendChild(renderer.view);


var stage = new PIXI.Container();



var videoElement = document.createElement("video");

function failed(e) {
      var text = new PIXI.Text(e.target.error.code, {fontFamily : 'Arial', fontSize: 30, fill : 0xff1010, align : 'center'});
        text.x = 200;
        text.y = 200;
        stage.addChild(text);
}
      


videoElement.onerror = failed;
videoElement.onabort = failed;
videoElement.onsuspend = failed;
videoElement.onstalled = failed;
      
      
videoElement.preload = "none";

videoElement.src = "vid25.mp4";
videoElement.type ='video/mp4';

videoElement.setAttribute("muted", true);
videoElement.setAttribute("autoplay", true);
videoElement.setAttribute("loop", true);
videoElement.setAttribute('playsinline', true);
videoElement.setAttribute('controls', true);
videoElement.controls = true;
videoElement.muted = true;
videoElement.autoplay = true;
videoElement.loop = true;
videoElement.playsinline = true;

setInterval(function(){ 
        var text = new PIXI.Text(videoElement.readyState, {fontFamily : 'Arial', fontSize: 30, fill : 0xff1010, align : 'center'});
        text.x = 100;
        text.y = 100;
        stage.addChild(text);
    }, 2000);



console.assert(videoElement.muted);



var texture = PIXI.Texture.fromVideo(videoElement);



var videoSprite = new PIXI.Sprite(texture);






var fps = 60;



if(fps !== 60) {

    texture.baseTexture.autoUpdate = false;

    setInterval(() => {

        texture.update();

    }, Math.floor(1000 / fps));

}


stage.addChild(videoSprite);



animate();



function animate(){

    renderer.render(stage);



    requestAnimationFrame(animate);

}




</script>

</body>
